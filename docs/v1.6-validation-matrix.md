# üìã v1.6 Validation Matrix

**Version:** 1.6.0  
**Focus:** New v1.5 Field Validation  
**Created:** October 18, 2025

---

## üéØ Validation Strategy

### **Draft vs Publish Rules**
- **Draft Mode:** Saves all data, shows warnings only
- **Publish Mode:** Blocks submission on validation errors
- **Error Display:** Inline field-level messages + summary panel

---

## üìù Template Mode Validation

### **platformVersion**
```yaml
Field: platformVersion
Required: Optional
Type: string
Pattern: ^v?\d+(\.\d+)?(\.\d+)?$
Examples: "v2.0", "3.5", "v1.0.1", "4"
Default: null
Error Messages:
  - pattern: "Version must be like 'v2.0' or '3.5'"
  - tooLong: "Version number too long (max 10 characters)"
Draft: Allowed with warning
Publish: Blocked if invalid pattern
```

### **useCaseCategory**
```yaml
Field: useCaseCategory
Required: Optional
Type: enum
Options: 
  - content-creation
  - analysis
  - coding
  - customer-service
  - education
  - research
  - creative-writing
  - data-processing
  - automation
Default: null
Error Messages:
  - invalid: "Please select a valid use case category"
  - missing: "Consider selecting a category for better results"
Draft: Always allowed
Publish: Blocked if value not in enum
```

### **finalOutputFormat**
```yaml
Field: finalOutputFormat
Required: Optional
Type: enum
Options:
  - text
  - markdown
  - json
  - xml
  - html
  - code
  - structured-data
  - csv
  - yaml
Default: "text"
Error Messages:
  - invalid: "Please select a valid output format"
Draft: Always allowed
Publish: Blocked if value not in enum
```

### **audienceSensitivity**
```yaml
Field: audienceSensitivity
Required: Optional (Recommended)
Type: enum
Options:
  - low (general audience)
  - medium (professional context)
  - high (sensitive content)
Default: "medium"
Error Messages:
  - invalid: "Please select a sensitivity level"
  - recommended: "Setting sensitivity helps filter content appropriately"
Draft: Always allowed
Publish: Warning if empty, proceed allowed
```

---

## üéØ Agent Mode Validation

### **agentName**
```yaml
Field: agentName
Required: Optional
Type: string
MinLength: 2
MaxLength: 50
Pattern: ^[a-zA-Z0-9\s\-\.]+$
Examples: "Dr. Data", "CodeMaster-3000", "Assistant v2"
Default: null (falls back to title)
Error Messages:
  - tooShort: "Agent name needs at least 2 characters"
  - tooLong: "Agent name too long (max 50 characters)"
  - pattern: "Use letters, numbers, spaces, hyphens, or dots only"
  - fallback: "Using title as agent name"
Draft: Always allowed
Publish: Blocked if invalid pattern or length
```

### **personalityStyle**
```yaml
Field: personalityStyle
Required: Optional (Strongly Recommended)
Type: enum
Options:
  - professional
  - friendly-approachable
  - analytical
  - creative-imaginative
  - mentor-teacher
  - direct-efficient
  - empathetic-supportive
  - humorous-casual
Default: "professional"
Error Messages:
  - invalid: "Please select a valid personality style"
  - recommended: "Personality style enhances agent interactions"
Draft: Always allowed
Publish: Warning if empty, proceed allowed
```

---

## üé® Blueprint Mode Validation

### **mediaGenerator**
```yaml
Field: mediaGenerator
Required: Optional (Recommended for clarity)
Type: string
MinLength: 2
MaxLength: 100
Pattern: ^[a-zA-Z0-9\s\-\.\/]+$
Examples: "Midjourney v6", "DALL-E 3", "Stable Diffusion XL"
Default: null
Error Messages:
  - tooShort: "Generator name needs at least 2 characters"
  - tooLong: "Generator name too long (max 100 characters)"
  - pattern: "Use letters, numbers, spaces, hyphens, dots, or slashes"
  - recommended: "Specify generator for optimized prompts"
Draft: Always allowed
Publish: Warning if empty, proceed allowed
```

### **mediaAgent**
```yaml
Field: mediaAgent
Required: Optional
Type: string
MinLength: 2
MaxLength: 100
Pattern: ^[a-zA-Z0-9\s\-\,\.]+$
Examples: "Film Director", "VFX Supervisor", "Art Director, Cinematographer"
Default: null
Error Messages:
  - tooShort: "Agent role needs at least 2 characters"
  - tooLong: "Agent role too long (max 100 characters)"
  - pattern: "Use letters, numbers, spaces, hyphens, commas, or dots"
Draft: Always allowed
Publish: Blocked if invalid pattern or length
```

---

## üö¶ Validation Flow

### **On Field Blur (Focus Lost)**
1. Run field validation
2. Show inline error/warning if invalid
3. Update field border color (red=error, orange=warning, green=valid)
4. Add/remove error from validation summary

### **On Draft Save**
1. Run all validations
2. Show warnings only (no blocking)
3. Save all data regardless
4. Display info toast: "Draft saved with X warnings"

### **On Publish/Generate**
1. Run all validations
2. Block if any errors exist
3. Show error summary at top
4. Auto-scroll to first error
5. Highlight error fields
6. Display blocking toast: "Please fix X errors before publishing"

---

## üé® Visual Feedback States

### **Field States**
```css
/* Default */
border: 1px solid var(--border)

/* Valid */
border: 1px solid var(--success)
icon: ‚úì (green)

/* Warning */
border: 1px solid var(--warning)
icon: ‚ö† (orange)
message: italic, muted

/* Error */
border: 1px solid var(--destructive)
icon: ‚úó (red)
message: normal, destructive color

/* Focus */
border: 2px solid var(--primary)
outline: none
```

---

## üìä Error Message Guidelines

### **Message Tone**
- **Friendly:** "Looks like the version format needs adjustment"
- **Specific:** "Use format like 'v2.0' or '3.5'"
- **Actionable:** "Try removing special characters"
- **Brief:** Maximum 60 characters per message

### **Message Priority**
1. **Pattern errors** - Show first (most specific)
2. **Length errors** - Show second
3. **Required errors** - Show third
4. **Recommendation** - Show last (warnings)

---

## ‚úÖ Validation Summary Panel

### **Location:** Above form submit button
### **Content:**
```
[Error Icon] X errors preventing publish
[Warning Icon] Y warnings (optional improvements)

Errors:
‚Ä¢ platformVersion: Invalid format
‚Ä¢ agentName: Too many special characters

Warnings:
‚Ä¢ audienceSensitivity: Not set (recommended)
‚Ä¢ mediaGenerator: Not specified
```

### **Behavior:**
- Collapsible/expandable
- Updates in real-time
- Click item to scroll to field
- Red background for errors
- Orange background for warnings

---

## üîí Security Validations

### **All Text Fields**
- Strip HTML/script tags
- Escape special characters for display
- Limit unicode ranges (no control characters)
- Validate against injection patterns

### **Enum Fields**
- Strict whitelist validation
- No dynamic option insertion
- Server-side re-validation

### **Pattern Fields**
- Regex complexity limits
- Timeout on pattern matching
- Length limits before pattern check

---

## üìà Validation Metrics

### **Field Validation Success Rate Target**
- Draft saves: 100% (never block)
- Publish attempts: 85%+ success
- Field blur validation: <50ms response
- Full form validation: <200ms

### **Common Validation Failures (Expected)**
1. platformVersion format: ~10% of attempts
2. agentName special chars: ~5% of attempts
3. Missing recommendations: ~30% (warnings only)

---

## üéØ Implementation Notes

### **Client-Side (Immediate)**
- Zod schemas with `.refine()` for patterns
- React Hook Form integration
- Real-time validation on blur
- Debounced validation on type (300ms)

### **Server-Side (Backup)**
- Re-validate all fields
- Sanitize before storage
- Log validation failures
- Return specific error codes

### **Draft Storage**
- Save raw values to localStorage
- Include validation state
- Restore on page refresh
- Clear on successful publish

---

**Status:** VALIDATION RULES DEFINED  
**Next Step:** Implementation in component schemas